(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"40e4":function(e,t,n){"use strict";n.r(t);var a=n("d670"),r=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=r.a},"5acf":function(e,t,n){"use strict";var a=n("6644"),r=n.n(a);r.a},"62b1":function(e,t,n){"use strict";n.r(t);var a=n("6d5b"),r=n("40e4");for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);n("5acf");var c,i=n("f0c5"),s=Object(i["a"])(r["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],c);t["default"]=s.exports},6644:function(e,t,n){},"6d5b":function(e,t,n){"use strict";var a,r=function(){var e=this,t=e.$createElement;e._self._c},o=[];n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}))},"9f24":function(e,t,n){"use strict";(function(e){n("ff24");a(n("66fd"));var t=a(n("62b1"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},d670:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n("4795")),r=o(n("eb47"));function o(e){return e&&e.__esModule?e:{default:e}}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){return f(e)||l(e,t)||h(e,t)||d()}function d(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],a=!0,r=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(a=(c=i.next()).done);a=!0)if(n.push(c.value),t&&n.length===t)break}catch(s){r=!0,o=s}finally{try{a||null==i["return"]||i["return"]()}finally{if(r)throw o}}return n}}function f(e){if(Array.isArray(e))return e}function p(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=h(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r,o=!0,c=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return o=e.done,e},e:function(e){c=!0,r=e},f:function(){try{o||null==a.return||a.return()}finally{if(c)throw r}}}}function h(e,t){if(e){if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function b(e,t,n,a,r,o,c){try{var i=e[o](c),s=i.value}catch(u){return void n(u)}i.done?t(s):Promise.resolve(s).then(a,r)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){b(o,a,r,c,i,"next",e)}function i(e){b(o,a,r,c,i,"throw",e)}c(void 0)}))}}var v=function(){n.e("pages/index/components/message").then(function(){return resolve(n("ea3a"))}.bind(null,n)).catch(n.oe)},g=function(){n.e("pages/index/components/relation").then(function(){return resolve(n("3a31"))}.bind(null,n)).catch(n.oe)},w={data:function(){return{initData:{userInfomation:{avatar:"https://contact-1301049202.cos.ap-chongqing.myqcloud.com/73539711_p0_master1200.jpg",id:null,username:null,nickname:null,email:null,gender:null,birthday:null,phone:null,signature:null,createdAt:null,updatedAt:null},message:[]},cardIndex:0,left:[],top:[],announcement:[],showProcess:!1,announcementItem:{},process:{avatar:"",name:"",describe:"",announcementType:null}}},onLoad:function(){var t=this;this.initDataEvent(),e.$on("reloadMyInformation",(function(){t.initDataEvent()})),this.$socket.on("globalInsertAnnouncement",(function(e){e===t.initData.userInfomation.id&&t.initDataEvent()}))},onShow:function(){e.$emit("reloadMessage")},methods:{initDataEvent:function(){var t=this;return y(a.default.mark((function n(){var o,c,i,s,d;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.request({method:"POST",url:t.$baseURL+"userInfomation",data:"",header:{"Content-Type":"application/json;charset=utf-8",Authorization:"".concat(e.getStorageSync("token"))}});case 2:if(o=n.sent[1].data,200!==o.status){n.next=16;break}return getApp().globalData.myInformation=o.data,e.$emit("reloadDetail"),o.data.createdAt=(0,r.default)(new Date(o.data.createdAt)),o.data.birthday=(0,r.default)(new Date(o.data.birthday)),o.data.updatedAt=(0,r.default)(new Date(o.data.updatedAt)),t.initData.userInfomation=o.data,n.next=12,e.request({method:"POST",url:t.$baseURL+"getAnnouncement",data:null,header:{"Content-Type":"application/json;charset=utf-8",Authorization:"".concat(e.getStorageSync("token"))}});case 12:if(c=n.sent[1].data,200===c.status){t.announcement=c.data,i=p(t.announcement.entries());try{for(i.s();!(s=i.n()).done;)d=u(s.value,2),d[0],d[1],t.left.push(90*Math.random()+5),t.top.push(90*Math.random()+5)}catch(a){i.e(a)}finally{i.f()}}else e.showToast({title:"获取通知异常",icon:"none"});n.next=19;break;case 16:e.showToast({title:"授权过期或异常",icon:"none"}),e.removeStorageSync("token"),e.reLaunch({url:"../login/login"});case 19:case"end":return n.stop()}}),n)})))()},showProcessEvent:function(t){var n=this;return y(a.default.mark((function r(){var o;return a.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:n.showProcess=!0,n.announcementItem=n.announcement[t],n.process.avatar=n.announcement[t].sender.avatar||n.announcement[t].sender.cover,n.process.name=n.announcement[t].sender.username||n.announcement[t].sender.crowdName,n.process.announcementType=n.announcement[t].announcementType,a.t0=n.process.announcementType,a.next=0===a.t0?8:1===a.t0?10:2===a.t0?12:3===a.t0?14:16;break;case 8:return n.process.describe="".concat(n.process.name,"关注了你"),a.abrupt("break",16);case 10:return n.process.describe="".concat(n.process.name,"申请加入群：").concat(n.announcement[t].process.crowdName),a.abrupt("break",16);case 12:return n.process.describe="".concat(n.process.name,"邀请你加入群：").concat(n.announcement[t].process.crowdName),a.abrupt("break",16);case 14:return n.process.describe="".concat(n.process.name,"退出了群：").concat(n.announcement[t].process.crowdName),a.abrupt("break",16);case 16:if(0!==n.process.announcementType&&3!==n.process.announcementType&&4!==n.process.announcementType&&5!==n.process.announcementType){a.next=21;break}return a.next=19,e.request({method:"POST",url:n.$baseURL+"handelAnnouncement",data:JSON.stringify(i({},n.announcement[t])),header:{"Content-Type":"application/json;charset=utf-8",Authorization:"".concat(e.getStorageSync("token"))}});case 19:o=a.sent[1].data,200===o.status?n.initDataEvent():e.showToast({title:"处理异常",icon:"none"});case 21:case"end":return a.stop()}}),r)})))()},denyEvent:function(t){var n=this;return y(a.default.mark((function r(){var o,c;return a.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:a.t0=t.announcementType,a.next=1===a.t0?3:2===a.t0?8:13;break;case 3:return a.next=5,e.request({method:"POST",url:n.$baseURL+"handelAnnouncement",data:JSON.stringify(i({},t,{operation:"deny"})),header:{"Content-Type":"application/json;charset=utf-8",Authorization:"".concat(e.getStorageSync("token"))}});case 5:return o=a.sent[1].data,200===o.status?(n.initDataEvent(),n.showProcess=!1):(e.showToast({title:"处理异常",icon:"none"}),n.initDataEvent(),n.showProcess=!1),a.abrupt("break",14);case 8:return a.next=10,e.request({method:"POST",url:n.$baseURL+"handelAnnouncement",data:JSON.stringify(i({},t,{operation:"deny"})),header:{"Content-Type":"application/json;charset=utf-8",Authorization:"".concat(e.getStorageSync("token"))}});case 10:return c=a.sent[1].data,200===c.status?(n.initDataEvent(),n.showProcess=!1):(e.showToast({title:"处理异常",icon:"none"}),n.initDataEvent(),n.showProcess=!1),a.abrupt("break",14);case 13:return a.abrupt("break",14);case 14:case"end":return a.stop()}}),r)})))()},acceptEvent:function(t){var n=this;return y(a.default.mark((function r(){var o,c,s,u;return a.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:a.t0=t.announcementType,a.next=1===a.t0?3:2===a.t0?17:31;break;case 3:return a.next=5,e.request({method:"POST",url:n.$baseURL+"handelAnnouncement",data:JSON.stringify(i({},t,{operation:"accept"})),header:{"Content-Type":"application/json;charset=utf-8",Authorization:"".concat(e.getStorageSync("token"))}});case 5:if(o=a.sent[1].data,200!==o.status){a.next=13;break}return a.next=9,e.request({method:"POST",url:n.$baseURL+"insertMessageBox",data:JSON.stringify({information:{id:t.processId,crowdName:""},mode:3,members:[t.sendId]}),header:{"Content-Type":"application/json;charset=utf-8",Authorization:"".concat(e.getStorageSync("token"))}});case 9:c=a.sent[1].data,200===c.status?(e.$emit("reloadMessage"),e.$emit("reloadRelation"),n.initDataEvent(),n.showProcess=!1):(e.showToast({title:"处理异常",icon:"none"}),n.initDataEvent(),n.showProcess=!1),a.next=16;break;case 13:e.showToast({title:"处理异常",icon:"none"}),n.initDataEvent(),n.showProcess=!1;case 16:return a.abrupt("break",32);case 17:return a.next=19,e.request({method:"POST",url:n.$baseURL+"handelAnnouncement",data:JSON.stringify(i({},t,{operation:"accept"})),header:{"Content-Type":"application/json;charset=utf-8",Authorization:"".concat(e.getStorageSync("token"))}});case 19:if(s=a.sent[1].data,200!==s.status){a.next=27;break}return a.next=23,e.request({method:"POST",url:n.$baseURL+"insertMessageBox",data:JSON.stringify({information:{id:t.processId,crowdName:""},mode:3,members:[t.receiveId]}),header:{"Content-Type":"application/json;charset=utf-8",Authorization:"".concat(e.getStorageSync("token"))}});case 23:u=a.sent[1].data,200===u.status?(e.$emit("reloadMessage"),e.$emit("reloadRelation"),n.initDataEvent(),n.showProcess=!1):(e.showToast({title:"处理异常",icon:"none"}),n.initDataEvent(),n.showProcess=!1),a.next=30;break;case 27:e.showToast({title:"处理异常",icon:"none"}),n.initDataEvent(),n.showProcess=!1;case 30:return a.abrupt("break",32);case 31:return a.abrupt("break",32);case 32:case"end":return a.stop()}}),r)})))()},hideProcessEvent:function(){this.showProcess=!1},searchEvent:function(){e.navigateTo({url:"/pages/search/search"})},toDetailEvent:function(){e.navigateTo({url:"/pages/detail/detail?avatar=".concat(this.initData.userInfomation.avatar,"&username=").concat(this.initData.userInfomation.username,"&nickname=").concat(this.initData.userInfomation.nickname,"&email=").concat(this.initData.userInfomation.email,"&gender=").concat(this.initData.userInfomation.gender,"&birthday=").concat(this.initData.userInfomation.birthday,"&phone=").concat(this.initData.userInfomation.phone,"&signature=").concat(this.initData.userInfomation.signature,"&createdAt=").concat(this.initData.userInfomation.createdAt)})},toCreateCrowdEvent:function(){e.navigateTo({url:"../createCrowd/createCrowd"})},changeCardEvent:function(e){this.cardIndex=e}},components:{message:v,relation:g}};t.default=w}).call(this,n("543d")["default"])}},[["9f24","common/runtime","common/vendor"]]]);